# Agent-agnostic alias for agents-71-codex-belt-dispatcher.
# Keeps the old filename working while new callers use this name.
name: Agents Belt Dispatcher

on:
  workflow_call:
    inputs:
      agent_key:
        description: 'Agent key to dispatch'
        required: false
        default: 'codex'
        type: string
      force_issue:
        description: 'Issue number to dispatch immediately'
        required: false
        default: ''
        type: string
      dry_run:
        description: 'Preview actions without writes'
        required: false
        default: false
        type: boolean
    secrets:
      ACTIONS_BOT_PAT:
        required: false
      WORKFLOWS_APP_ID:
        required: false
      WORKFLOWS_APP_PRIVATE_KEY:
        required: false
    outputs:
      agent_key:
        description: 'Agent key used'
        value: ${{ jobs.delegate.outputs.agent_key }}
      issue:
        description: 'Issue selected'
        value: ${{ jobs.delegate.outputs.issue }}
      branch:
        description: 'Branch for the issue'
        value: ${{ jobs.delegate.outputs.branch }}
      base:
        description: 'Base branch'
        value: ${{ jobs.delegate.outputs.base }}
      reason:
        description: 'Selection reason'
        value: ${{ jobs.delegate.outputs.reason }}
      dry_run:
        description: 'Dry-run flag'
        value: ${{ jobs.delegate.outputs.dry_run }}

permissions:
  contents: write
  issues: write
  actions: write

jobs:
  delegate:
    uses: ./.github/workflows/agents-71-codex-belt-dispatcher.yml
    with:
      agent_key: ${{ inputs.agent_key }}
      force_issue: ${{ inputs.force_issue }}
      dry_run: ${{ inputs.dry_run }}
    secrets: inherit
